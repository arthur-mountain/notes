# 子網路(Subnet)

子網路、遮罩、固定 IP 和浮動 IP 都是網路配置中的重要概念。

子網路主要是將一個大的網路(例如一整個網段)劃分成多個較小的區塊，以便更有效地分配網路資源、降低流量擁堵並提升網路效能。

---

## 1. 子網路是什麼？

- **定義與目的**

  子網路就是將一個大型網路分割成較小的網路區塊。

  這樣的劃分有助於:

  - 減少因設備數量龐大而直接通信導致的網路擁堵。

  - 使各個子網中的設備僅與同一子網內的其他設備直接通信。

  - 根據需求靈活管理及分配 IP 範圍。

- **核心概念**

  - **劃分邏輯網路**:

    利用「子網路遮罩」將一個大的網路劃分為多個小網路。

  - **隔離流量**:

    同一子網內的設備可直接通信，而跨子網通信則必須透過路由器。

  - **靈活管理**:

    每個子網可以根據具體需求獨立分配 IP 範圍。

---

## 2. 子網路遮罩 (Subnet Mask) 是什麼？

- **功能與作用**

  子網路遮罩用來定義一個子網的大小，其格式與 IP 位址相似，例如 `255.255.255.0`。

  遮罩的主要功能是將 IP 位址分成「網路部分」和「主機部分」，其中:

  - **網路部分(Network Bits)**:

    用來標識子網，也就是所有設備共享的部分。

  - **主機部分(Host Bits)**:

    用來標識子網中的具體設備(如電腦、路由器、手機等)。

- **格式與例子**

  - 在 IPv4 中，遮罩是一個 32 位的數字，通常以點分十進制表示。

  - 例如:

    若有 IP `192.168.1.1` 與遮罩 `255.255.255.0`，其二進位形式為

    ```plaintext
    11111111.11111111.11111111.00000000
    ```

    表示前 24 位為網路位，後 8 位為主機位。這意味著:

    - 網路範圍為 `192.168.1.0`

    - 可用主機 IP 範圍為 `192.168.1.1` 至 `192.168.1.254`(其中 0 為網路地址，255 為廣播地址)。

- **備註**:

  -「掩碼」與「遮罩」是相同的概念，只是翻譯的不同而已。

---

## 3. 子網路的劃分

- **依據遮罩長度進行劃分**

  子網的劃分基於子網路遮罩的長度，[常用 CIDR 表示法](cidr-and-mask.md)

- **子網內可用主機數計算**

  可用主機數量計算公式為:

  ```plaintext
  2^(主機位數) - 2
  ```

  其中減去的 2 分別代表網路地址與廣播地址。

---

## 4. 範例: 將一個大的網路分割成小的子網路

假設有一個大的網路 `192.168.1.0/24`，遮罩為 `255.255.255.0`，整個網段包含 `192.168.1.0 - 192.168.1.255` 共 256 個地址。

然而，由於這樣龐大的網路可能導致流量擁堵，因此需要劃分成較小的子網。

### 步驟 1: 劃分子網路

[範例: 將 `/24` 劃分成兩個 `/25` 的子網](cidr-and-mask.md#範例-將-24-劃分成兩個-25-的子網)

### 步驟 2: 如何區分子網

當設備收到一個 IP 位址時，會根據子網路遮罩判斷其所屬子網。以 IP `192.168.1.65` 為例:

- **位元運算過程**:

  - IP 地址: `192.168.1.65`(二進位: `11000000.10101000.00000001.01000001`)

  - 子網遮罩: `255.255.255.128`(二進位: `11111111.11111111.11111111.10000000`)

  - 執行位元 AND 運算後得到:

    ```plaintext
    11000000.10101000.00000001.00000000
    ```

    結果為 `192.168.1.0`，說明 `192.168.1.65` 屬於子網 1。

### 步驟 3: 子網隔離的效果

- **同一子網內通信**:

  同一子網內(例如 `192.168.1.65` 與 `192.168.1.100`)的設備可以直接通信，不需要透過路由器。

- **跨子網通信**:

  若設備屬於不同子網(例如 `192.168.1.65` 屬於子網 1，而 `192.168.1.200` 屬於子網 2)，其通信必須通過路由器進行轉發。

---

## 總結

- 子網路和子網路遮罩是定義網路架構的重要工具，能夠將一個大的網路劃分為多個較小的子網，從而降低網路流量擁堵、提升管理效率及加強安全性。

- 實際劃分範例中，將 `192.168.1.0/24` 分割為兩個 `/25` 子網後，利用位元 AND 運算可確定每台設備所屬子網，並保證同一子網內能直接通信，而跨子網則需透過路由器轉發。
